res <- res[res$value != res$max, ]
res <- rbind(maxs, res)
res <- res[,1:3]
# remove cycles from the data
res[, 1] <- paste0(res[, 1], " ")
res[, 2] <- paste0(" ", res[, 2])
colnames(res) <- c("From", "To", "Weight")
if(!is.null(colors)) {
colors <- paste(colors, collapse = "', '")
colors <- paste0("['", colors, "']")
}
Sankey <- gvisSankey(
res,
from="From",
to="To",
weight="Weight",
options = list(
width = 700,
height = 1000,
sankey = paste0("{
node:{
label:{
fontName:'Arial',
fontSize:11,color:
'#000000',
bold:true,
italic:false
},
colors:'#FFFFFF',
nodePadding:12
},", if(!is.null(colors)) {
paste0("link:{
colorMode: 'source',
colors: ", colors, "
},")},
"iterations:0
}"
))
)
plot(Sankey)
d <- read.csv("D:/workspace/zhang_scDeepCluster/csv/worm.csv")
reference <- d$true
clusters <- d$pred
colors <- c(
'#9933FA',
'#D2B48C',
'#FFA500',
'#DDA0DD',
'#BDFCC9',
'#7FFFD4',
'#57A5D6',
'#B0E0E6',
'#FFFFCD',
'#FCE6C9'
)
res.all <- NULL
for(j in 1:10){
res <- NULL
for(i in 1:10) {
tmp <- length(intersect(which(clusters == i), which(reference == j)))
res <- c(res, tmp)
}
res.all <- rbind(res.all, res)
}
colnames(res.all) <- 1:10
rownames(res.all) <- 1:10
res <- melt(res.all)
res <- res[res$value != 0, ]
maxs <- res %>%
group_by(Var1) %>%
dplyr::summarise(max = max(value))
res <- merge(res, maxs)
maxs <- res[res$value == res$max, ]
res <- res[res$value != res$max, ]
res <- rbind(maxs, res)
res <- res[,1:3]
# remove cycles from the data
res[, 1] <- paste0(res[, 1], " ")
res[, 2] <- paste0(" ", res[, 2])
colnames(res) <- c("From", "To", "Weight")
if(!is.null(colors)) {
colors <- paste(colors, collapse = "', '")
colors <- paste0("['", colors, "']")
}
Sankey <- gvisSankey(
res,
from="From",
to="To",
weight="Weight",
options = list(
width = 700,
height = 1000,
sankey = paste0("{
node:{
label:{
fontName:'Arial',
fontSize:11,color:
'#000000',
bold:true,
italic:false
},
colors:'#FFFFFF',
nodePadding:12
},", if(!is.null(colors)) {
paste0("link:{
colorMode: 'source',
colors: ", colors, "
},")},
"iterations:0
}"
))
)
plot(Sankey)
###mouse_bladder
d <- read.csv("D:/workspace/zhang_scDeepCluster/csv/mouse_bladder.csv")
reference <- d$true
clusters <- d$pred
colors <- c(
'#9933FA',
'#D2B48C',
'#FFA500',
'#DDA0DD',
'#BDFCC9','#BDFCC9',
'#7FFFD4','#7FFFD4',
'#57A5D6','#57A5D6',
'#B0E0E6','#B0E0E6',
'#FFFFCD','#FFFFCD',
'#FCE6C9','#FCE6C9'
)
res.all <- NULL
for(j in 1:16){
res <- NULL
for(i in 1:16) {
tmp <- length(intersect(which(clusters == i), which(reference == j)))
res <- c(res, tmp)
}
res.all <- rbind(res.all, res)
}
colnames(res.all) <- 1:16
rownames(res.all) <- 1:16
res <- melt(res.all)
res <- res[res$value != 0, ]
maxs <- res %>%
group_by(Var1) %>%
dplyr::summarise(max = max(value))
res <- merge(res, maxs)
maxs <- res[res$value == res$max, ]
res <- res[res$value != res$max, ]
res <- rbind(maxs, res)
res <- res[,1:3]
# remove cycles from the data
res[, 1] <- paste0(res[, 1], " ")
res[, 2] <- paste0(" ", res[, 2])
colnames(res) <- c("From", "To", "Weight")
if(!is.null(colors)) {
colors <- paste(colors, collapse = "', '")
colors <- paste0("['", colors, "']")
}
Sankey <- gvisSankey(
res,
from="From",
to="To",
weight="Weight",
options = list(
width = 700,
height = 1000,
sankey = paste0("{
node:{
label:{
fontName:'Arial',
fontSize:11,color:
'#000000',
bold:true,
italic:false
},
colors:'#FFFFFF',
nodePadding:12
},", if(!is.null(colors)) {
paste0("link:{
colorMode: 'source',
colors: ", colors, "
},")},
"iterations:0
}"
))
)
plot(Sankey)
install.packages('Seurat')
library('Seurat')
data <- read.csv(file = "D:/workspace/zhang_scDeepClusterexample/try.csv", row.names = FALSE, header = TRUE)
data <- read.csv('D:/workspace/zhang_scDeepClusterexample/try.csv')
data <- read.csv('D:/workspace/zhang_scDeepCluster/try.csv')
View(data)
seurat_object <- CreateSeuratObject(counts = data)
seurat_object <- NormalizeData(seurat_object)
seurat_object <- FindVariableFeatures(seurat_object)
seurat_object <- ScaleData(seurat_object)
# 进行降维和聚类
seurat_object <- RunPCA(seurat_object)
seurat_object <- FindNeighbors(seurat_object)
seurat_object <- FindClusters(seurat_object)
# 输出聚类标签
cluster_labels <- Idents(seurat_object)
head(cluster_labels)
length(cluster_labels)
cluster_labels[:10]
cluster_labels(1:10)
cluster_labels(1)
cluster_labels[1]
cluster_labels[2]
seurat_object <- CreateSeuratObject(counts = data)
seurat_object <- NormalizeData(seurat_object)
seurat_object <- FindVariableFeatures(seurat_object)
seurat_object <- ScaleData(seurat_object)
# 进行降维和聚类
seurat_object <- RunPCA(seurat_object)
seurat_object <- FindNeighbors(seurat_object)
seurat_object <- FindClusters(seurat_object,resolution = 0.3)
# 输出聚类标签
cluster_labels <- Idents(seurat_object)
head(cluster_labels)
seurat_object <- CreateSeuratObject(counts = data)
seurat_object <- NormalizeData(seurat_object)
seurat_object <- FindVariableFeatures(seurat_object)
seurat_object <- ScaleData(seurat_object)
# 进行降维和聚类
seurat_object <- RunPCA(seurat_object)
seurat_object <- FindNeighbors(seurat_object)
seurat_object <- FindClusters(seurat_object,resolution = 0.2)
# 输出聚类标签
cluster_labels <- Idents(seurat_object)
head(cluster_labels)
seurat_object <- CreateSeuratObject(counts = data)
seurat_object <- NormalizeData(seurat_object)
seurat_object <- FindVariableFeatures(seurat_object)
seurat_object <- ScaleData(seurat_object)
# 进行降维和聚类
seurat_object <- RunPCA(seurat_object)
seurat_object <- FindNeighbors(seurat_object)
seurat_object <- FindClusters(seurat_object,resolution = 0.1)
# 输出聚类标签
cluster_labels <- Idents(seurat_object)
head(cluster_labels)
seurat_object <- CreateSeuratObject(counts = data)
seurat_object <- NormalizeData(seurat_object)
seurat_object <- FindVariableFeatures(seurat_object)
seurat_object <- ScaleData(seurat_object)
# 进行降维和聚类
seurat_object <- RunPCA(seurat_object)
seurat_object <- FindNeighbors(seurat_object)
seurat_object <- FindClusters(seurat_object,resolution = 0.16)
# 输出聚类标签
cluster_labels <- Idents(seurat_object)
head(cluster_labels)
library('Seurat')
data <- read.csv('D:/workspace/zhang_scDeepCluster/data_csv/pbmc.csv')
seurat_object <- CreateSeuratObject(counts = data)
seurat_object <- NormalizeData(seurat_object)
seurat_object <- FindVariableFeatures(seurat_object)
seurat_object <- ScaleData(seurat_object)
# 进行降维和聚类
seurat_object <- RunPCA(seurat_object)
seurat_object <- FindNeighbors(seurat_object)
seurat_object <- FindClusters(seurat_object,resolution = 0.16)
# 输出聚类标签
cluster_labels <- Idents(seurat_object)
head(cluster_labels)
getwd
getwd()
setwd('D:/workspace/zhang_scDeepCluster')
getwd()
write.csv(cluster_labels, file = "./data_csv/record/pbmc_cluster_labels.csv")
write.csv(cluster_labels, file = "./data_csv/record/pbmc_cluster_labels.csv",row.names = F,col.names = F)
write.csv(cluster_labels, file = "./data_csv/record/pbmc_cluster_labels.csv",row.names = F)
data <- read.csv('D:/workspace/zhang_scDeepCluster/data_csv/mouse_bladder.csv')
seurat_object <- CreateSeuratObject(counts = data)
seurat_object <- NormalizeData(seurat_object)
seurat_object <- FindVariableFeatures(seurat_object)
seurat_object <- ScaleData(seurat_object)
# 进行降维和聚类
seurat_object <- RunPCA(seurat_object)
seurat_object <- FindNeighbors(seurat_object)
seurat_object <- FindClusters(seurat_object,resolution = 0.5)
# 输出聚类标签
cluster_labels <- Idents(seurat_object)
head(cluster_labels)
seurat_object <- CreateSeuratObject(counts = data)
seurat_object <- NormalizeData(seurat_object)
seurat_object <- FindVariableFeatures(seurat_object)
seurat_object <- ScaleData(seurat_object)
# 进行降维和聚类
seurat_object <- RunPCA(seurat_object)
seurat_object <- FindNeighbors(seurat_object)
seurat_object <- FindClusters(seurat_object,resolution = 0.7)
# 输出聚类标签
cluster_labels <- Idents(seurat_object)
head(cluster_labels)
seurat_object <- CreateSeuratObject(counts = data)
seurat_object <- NormalizeData(seurat_object)
seurat_object <- FindVariableFeatures(seurat_object)
seurat_object <- ScaleData(seurat_object)
# 进行降维和聚类
seurat_object <- RunPCA(seurat_object)
seurat_object <- FindNeighbors(seurat_object)
seurat_object <- FindClusters(seurat_object,resolution = 0.9)
# 输出聚类标签
cluster_labels <- Idents(seurat_object)
head(cluster_labels)
seurat_object <- CreateSeuratObject(counts = data)
seurat_object <- NormalizeData(seurat_object)
seurat_object <- FindVariableFeatures(seurat_object)
seurat_object <- ScaleData(seurat_object)
# 进行降维和聚类
seurat_object <- RunPCA(seurat_object)
seurat_object <- FindNeighbors(seurat_object)
seurat_object <- FindClusters(seurat_object,resolution = 0.95)
# 输出聚类标签
cluster_labels <- Idents(seurat_object)
head(cluster_labels)
write.csv(cluster_labels, file = "./data_csv/record/mouse_bladder_cluster_labels.csv",row.names = F)
data <- read.csv('D:/workspace/zhang_scDeepCluster/data_csv/mouse_ES.csv')
seurat_object <- CreateSeuratObject(counts = data)
seurat_object <- NormalizeData(seurat_object)
seurat_object <- FindVariableFeatures(seurat_object)
seurat_object <- ScaleData(seurat_object)
# 进行降维和聚类
seurat_object <- RunPCA(seurat_object)
seurat_object <- FindNeighbors(seurat_object)
seurat_object <- FindClusters(seurat_object,resolution = 0.3)
# 输出聚类标签
cluster_labels <- Idents(seurat_object)
head(cluster_labels)
seurat_object <- CreateSeuratObject(counts = data)
seurat_object <- NormalizeData(seurat_object)
seurat_object <- FindVariableFeatures(seurat_object)
seurat_object <- ScaleData(seurat_object)
# 进行降维和聚类
seurat_object <- RunPCA(seurat_object)
seurat_object <- FindNeighbors(seurat_object)
seurat_object <- FindClusters(seurat_object,resolution = 0.1)
# 输出聚类标签
cluster_labels <- Idents(seurat_object)
head(cluster_labels)
seurat_object <- CreateSeuratObject(counts = data)
seurat_object <- NormalizeData(seurat_object)
seurat_object <- FindVariableFeatures(seurat_object)
seurat_object <- ScaleData(seurat_object)
# 进行降维和聚类
seurat_object <- RunPCA(seurat_object)
seurat_object <- FindNeighbors(seurat_object)
seurat_object <- FindClusters(seurat_object,resolution = 0.05)
# 输出聚类标签
cluster_labels <- Idents(seurat_object)
head(cluster_labels)
seurat_object <- CreateSeuratObject(counts = data)
seurat_object <- NormalizeData(seurat_object)
seurat_object <- FindVariableFeatures(seurat_object)
seurat_object <- ScaleData(seurat_object)
# 进行降维和聚类
seurat_object <- RunPCA(seurat_object)
seurat_object <- FindNeighbors(seurat_object)
seurat_object <- FindClusters(seurat_object,resolution = 0.08)
# 输出聚类标签
cluster_labels <- Idents(seurat_object)
head(cluster_labels)
seurat_object <- CreateSeuratObject(counts = data)
seurat_object <- NormalizeData(seurat_object)
seurat_object <- FindVariableFeatures(seurat_object)
seurat_object <- ScaleData(seurat_object)
# 进行降维和聚类
seurat_object <- RunPCA(seurat_object)
seurat_object <- FindNeighbors(seurat_object)
seurat_object <- FindClusters(seurat_object,resolution = 0.07)
# 输出聚类标签
cluster_labels <- Idents(seurat_object)
head(cluster_labels)
seurat_object <- CreateSeuratObject(counts = data)
seurat_object <- NormalizeData(seurat_object)
seurat_object <- FindVariableFeatures(seurat_object)
seurat_object <- ScaleData(seurat_object)
# 进行降维和聚类
seurat_object <- RunPCA(seurat_object)
seurat_object <- FindNeighbors(seurat_object)
seurat_object <- FindClusters(seurat_object,resolution = 0.075)
# 输出聚类标签
cluster_labels <- Idents(seurat_object)
head(cluster_labels)
seurat_object <- CreateSeuratObject(counts = data)
seurat_object <- NormalizeData(seurat_object)
seurat_object <- FindVariableFeatures(seurat_object)
seurat_object <- ScaleData(seurat_object)
# 进行降维和聚类
seurat_object <- RunPCA(seurat_object)
seurat_object <- FindNeighbors(seurat_object)
seurat_object <- FindClusters(seurat_object,resolution = 0.078)
# 输出聚类标签
cluster_labels <- Idents(seurat_object)
head(cluster_labels)
seurat_object <- CreateSeuratObject(counts = data)
seurat_object <- NormalizeData(seurat_object)
seurat_object <- FindVariableFeatures(seurat_object)
seurat_object <- ScaleData(seurat_object)
# 进行降维和聚类
seurat_object <- RunPCA(seurat_object)
seurat_object <- FindNeighbors(seurat_object)
seurat_object <- FindClusters(seurat_object,resolution = 0.073)
# 输出聚类标签
cluster_labels <- Idents(seurat_object)
head(cluster_labels)
seurat_object <- CreateSeuratObject(counts = data)
seurat_object <- NormalizeData(seurat_object)
seurat_object <- FindVariableFeatures(seurat_object)
seurat_object <- ScaleData(seurat_object)
# 进行降维和聚类
seurat_object <- RunPCA(seurat_object)
seurat_object <- FindNeighbors(seurat_object)
seurat_object <- FindClusters(seurat_object,resolution = 0.07)
# 输出聚类标签
cluster_labels <- Idents(seurat_object)
head(cluster_labels)
seurat_object <- CreateSeuratObject(counts = data)
seurat_object <- NormalizeData(seurat_object)
seurat_object <- FindVariableFeatures(seurat_object)
seurat_object <- ScaleData(seurat_object)
# 进行降维和聚类
seurat_object <- RunPCA(seurat_object)
seurat_object <- FindNeighbors(seurat_object)
seurat_object <- FindClusters(seurat_object,resolution = 0.06)
# 输出聚类标签
cluster_labels <- Idents(seurat_object)
head(cluster_labels)
write.csv(cluster_labels, file = "./data_csv/record/mouse_ES_cluster_labels.csv",row.names = F)
data <- read.csv('D:/workspace/zhang_scDeepCluster/data_csv/worm.csv')
data <- read.csv('D:/workspace/zhang_scDeepCluster/data_csv/worm.csv')
seurat_object <- CreateSeuratObject(counts = data)
seurat_object <- NormalizeData(seurat_object)
seurat_object <- FindVariableFeatures(seurat_object)
seurat_object <- ScaleData(seurat_object)
# 进行降维和聚类
seurat_object <- RunPCA(seurat_object)
seurat_object <- FindNeighbors(seurat_object)
seurat_object <- FindClusters(seurat_object,resolution = 0.5)
# 输出聚类标签
cluster_labels <- Idents(seurat_object)
head(cluster_labels)
seurat_object <- CreateSeuratObject(counts = data)
seurat_object <- NormalizeData(seurat_object)
seurat_object <- FindVariableFeatures(seurat_object)
seurat_object <- ScaleData(seurat_object)
# 进行降维和聚类
seurat_object <- RunPCA(seurat_object)
seurat_object <- FindNeighbors(seurat_object)
seurat_object <- FindClusters(seurat_object,resolution = 0.3)
# 输出聚类标签
cluster_labels <- Idents(seurat_object)
head(cluster_labels)
seurat_object <- CreateSeuratObject(counts = data)
seurat_object <- NormalizeData(seurat_object)
seurat_object <- FindVariableFeatures(seurat_object)
seurat_object <- ScaleData(seurat_object)
# 进行降维和聚类
seurat_object <- RunPCA(seurat_object)
seurat_object <- FindNeighbors(seurat_object)
seurat_object <- FindClusters(seurat_object,resolution = 0.1)
# 输出聚类标签
cluster_labels <- Idents(seurat_object)
head(cluster_labels)
seurat_object <- CreateSeuratObject(counts = data)
seurat_object <- NormalizeData(seurat_object)
seurat_object <- FindVariableFeatures(seurat_object)
seurat_object <- ScaleData(seurat_object)
# 进行降维和聚类
seurat_object <- RunPCA(seurat_object)
seurat_object <- FindNeighbors(seurat_object)
seurat_object <- FindClusters(seurat_object,resolution = 0.2)
# 输出聚类标签
cluster_labels <- Idents(seurat_object)
head(cluster_labels)
seurat_object <- CreateSeuratObject(counts = data)
seurat_object <- NormalizeData(seurat_object)
seurat_object <- FindVariableFeatures(seurat_object)
seurat_object <- ScaleData(seurat_object)
# 进行降维和聚类
seurat_object <- RunPCA(seurat_object)
seurat_object <- FindNeighbors(seurat_object)
seurat_object <- FindClusters(seurat_object,resolution = 0.17)
# 输出聚类标签
cluster_labels <- Idents(seurat_object)
head(cluster_labels)
seurat_object <- CreateSeuratObject(counts = data)
seurat_object <- NormalizeData(seurat_object)
seurat_object <- FindVariableFeatures(seurat_object)
seurat_object <- ScaleData(seurat_object)
# 进行降维和聚类
seurat_object <- RunPCA(seurat_object)
seurat_object <- FindNeighbors(seurat_object)
seurat_object <- FindClusters(seurat_object,resolution = 0.15)
# 输出聚类标签
cluster_labels <- Idents(seurat_object)
head(cluster_labels)
seurat_object <- CreateSeuratObject(counts = data)
seurat_object <- NormalizeData(seurat_object)
seurat_object <- FindVariableFeatures(seurat_object)
seurat_object <- ScaleData(seurat_object)
# 进行降维和聚类
seurat_object <- RunPCA(seurat_object)
seurat_object <- FindNeighbors(seurat_object)
seurat_object <- FindClusters(seurat_object,resolution = 0.12)
# 输出聚类标签
cluster_labels <- Idents(seurat_object)
head(cluster_labels)
write.csv(cluster_labels, file = "./data_csv/record/worm.csv",row.names = F)
